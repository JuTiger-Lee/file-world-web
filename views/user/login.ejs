<%- include('../common/header.ejs') %>
    <link rel="stylesheet" href="../static/css/user/login.css">
    <div id="login-box">
        <div class="row">
            <div class="col-md-12">
                <div class="login-title-logo-box" style="text-align: center;">
                    <h1>File<span class="header-world-logo"> W<i class="fas fa-globe fa-sm"></i>rld</span></h1>
                </div>
                <div class="login-form-box">
                    <form>
                        <div class="form-group">
                            <input type="id" class="form-control user-id" placeholder="ID">
                        </div>
                        <div class="form-group">
                            <input type="password" class="form-control user-password" placeholder="Password">
                        </div>

                        <div class="login-btn-box">
                            <div class="login-local-btn btn btn-primary">
                                <span>Login</span>
                            </div>
                            <div class="login-google-btn btn btn-secondary">
                                <span><i style="float:left; font-size:23px" class="fab fa-google-plus-g"></i> Login With
                                    Google</span>
                            </div>
                            <div class="login-facebook-btn btn btn-secondary">
                                <span><i style="float:left; font-size:23px" class="fab fa-facebook-square"></i> Login
                                    With Facebook</span>
                            </div>
                        </div>
                        <div class="login-forgot-password">
                            <p>for got your password?</p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        'use strict';

        const loginLocalBtn = document.querySelector('.login-local-btn');
        const loginGoogleBtn = document.querySelector('.login-google-btn');
        const loginFacebookBtn = document.querySelector('.login-facebook-btn');

        function loginValueCheck() {
            const userID = document.querySelector('.user-id').value;
            const userPassword = document.querySelector('.user-password').value;

            if (!userID.trim() || !userID) return alert('id를 입력해주세요.');
            if (!userPassword.trim() || !userPassword) return alert('password를 입력해주세요.');

            return {
                userID,
                userPassword,
            }
        }

        async function reqLogin() {
            const { userID, userPassword } = loginValueCheck();

            const bodyData = {
                ui_id: userID,
                ui_password: userPassword,
            }

            const reqResult = await reqAjax('/api/user/login', 'post', bodyData);

            if (reqResult.status === 261) {
                return alert('로그인 문제.');
            } else if (reqResult.status === 200) {
                // 토큰 저장
                localStorage.setItem('user', reqResult.data.token);
                
                return window.location.href = '/';
            } else {
                return alert('로그인 실패')
            }
        }

        loginLocalBtn.addEventListener('click', () => reqLogin());
        loginGoogleBtn.addEventListener('click', async function() {
            const reqResult = await reqAjax('/test', 'post', {});
        })
    </script>
<%- include('../common/footer.ejs') %>
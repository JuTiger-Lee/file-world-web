<%- include('../common/header.ejs') %>
    <link rel="stylesheet" href="../static/css/user/signin.css">

    <div id="login-box">
        <div class="row">
            <div class="col-md-12">
                <div class="login-title-logo-box" style="text-align: center;">
                    <h1>File<span class="header-world-logo"> W<i class="fas fa-globe fa-sm"></i>rld</span></h1>
                </div>
                <div class="login-form-box">
                    <form>
                        <div class="form-group">
                            <input type="id" class="form-control user-id" placeholder="ID">
                        </div>
                        <div class="form-group">
                            <input type="password" class="form-control user-password" placeholder="Password">
                        </div>

                        <div class="login-btn-box">
                            <div class="login-local-btn btn btn-primary">
                                <span>Login</span>
                            </div>
                            <div class="login-google-btn btn btn-secondary">
                                <span><i style="float:left; font-size:23px" class="fab fa-google-plus-g"></i> Login With
                                    Google</span>
                            </div>
                            <div class="login-facebook-btn btn btn-secondary">
                                <span><i style="float:left; font-size:23px" class="fab fa-facebook-square"></i> Login
                                    With Facebook</span>
                            </div>
                        </div>
                        <div class="login-forgot-password">
                            <p>for got your password?</p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        'use strict';

        const loginLocalBtn = document.querySelector('.login-local-btn');
        const loginGoogleBtn = document.querySelector('.login-google-btn');
        const loginFacebookBtn = document.querySelector('.login-facebook-btn');

        function loginValueCheck(userID, userPassword) {
            if (!userID.trim() || !userID) {
                return notification(
                    'warning',
                    'Enter required values',
                    'Please enter your ID.'
                );
            }

            if (!userPassword.trim() || !userPassword) {
                return notification(
                    'warning',
                    'Enter required values',
                    'Please enter your Password.'
                );
            }

            return true;
        }

        function reqDataCheck(reqResult) {
            if (reqResult.code === 200) {
                // 토큰 저장
                localStorage.setItem('token', reqResult.data[0].token);

                window.location.href = '/';
                return notification('success', 'LOGIN SUCCESS', 'login success');
            } else {
                return notification('warning', 'LOGIN FAIL', 'login fail');
            }
        }

        async function reqSignIn() {
            const userID = document.querySelector('.user-id').value;
            const userPassword = document.querySelector('.user-password').value;

            const loginValueResult = loginValueCheck(userID, userPassword);

            if (loginValueResult) {
                const bodyData = {
                    ui_id: userID,
                    ui_password: userPassword,
                };

                const reqResult = await reqAjax('/api/user/sign-in', 'post', bodyData);

                return reqDataCheck(reqResult);
            }
        }

        loginLocalBtn.addEventListener('click', () => reqSignIn());
    </script>
    <%- include('../common/footer.ejs') %>